tÃ³m táº¯t láº¡i toÃ n bá»™ Phase I (MVP) theo luá»“ng tá»± code giao sÃ¡ch + Cloudflare R2 + Shopify vÃ  gá»­i link báº±ng cáº£ Thank you page + Email Confirmation:

ğŸ“Œ Phase I â€“ MVP Há»‡ thá»‘ng giao ebook:

1. Háº¡ táº§ng lÆ°u trá»¯

	Táº¡o Cloudflare R2 bucket (private).

	Upload ebook theo cáº¥u trÃºc gá»n (vd: /the-last-bells/en/v1.pdf).

	Táº¡o KV Namespace (vd: TOKENS_PROD) Ä‘á»ƒ lÆ°u token download.

2. Worker xá»­ lÃ½

	Cloudflare Worker:

		Nháº­n webhook tá»« Shopify (orders/paid).

		Dá»±a trÃªn SKU sáº£n pháº©m, tra catalog.json â†’ xÃ¡c Ä‘á»‹nh file trong R2.

		Táº¡o token download (cÃ³ háº¡n 48h, max 3 lÆ°á»£t táº£i).

		LÆ°u token vÃ o KV.

	Endpoint Worker:

		/webhook/shopify â†’ nháº­n webhook, táº¡o record.

		/portal â†’ Portal page (KH truy cáº­p tá»« Thank you page/email).

		/d/<token> â†’ stream file tá»« R2, giáº£m lÆ°á»£t táº£i, kiá»ƒm tra TTL.

3. Portal Page

	Trang /portal:

		Náº¿u KH truy cáº­p kÃ¨m ?o={{ order_number }}&e={{ customer.email }} â†’ Worker xÃ¡c thá»±c trong KV â†’ hiá»ƒn thá»‹ link download.

		Náº¿u thiáº¿u dá»¯ liá»‡u â†’ hiá»‡n form cho KH nháº­p Email + Order number.

4. Gá»­i link cho KH theo 2 kÃªnh

	Thank you page:

		Trong Shopify Checkout â†’ Order status page, thÃªm má»™t nÃºt:

		https://dl.theepochmedia.com/portal?o={{ order_number | url_encode }}&e={{ checkout.email | url_encode }}


		KH thanh toÃ¡n xong â†’ click nÃºt â†’ vÃ o Portal â†’ táº£i ebook.

	Email Confirmation:

		Trong Shopify Admin â†’ Settings â†’ Notifications â†’ Order confirmation â†’ edit template.

		ThÃªm Ä‘oáº¡n nÃºt/link â€œAccess your downloadsâ€ trá» Ä‘áº¿n Portal cÃ¹ng query string.

		KH nháº­n email â†’ click â†’ vÃ o Portal â†’ táº£i ebook.

5. Tráº£i nghiá»‡m khÃ¡ch hÃ ng

	Ngay láº­p tá»©c: KH tháº¥y nÃºt táº£i trÃªn Thank you page.

	Dá»± phÃ²ng/lÃ¢u dÃ i: KH nháº­n email vá»›i nÃºt táº£i.

	Worker Ä‘áº£m báº£o link an toÃ n (cÃ³ háº¡n, giá»›i háº¡n lÆ°á»£t).


ğŸ‘‰ ÄÃ¢y lÃ  báº£n tÃ³m táº¯t Phase I:

	Háº¡ táº§ng: R2 + KV.

	Worker: webhook + token + portal + download.

	Portal: hiá»ƒn thá»‹ link táº£i.

	2 kÃªnh gá»­i link: Thank you page + Email Confirmation.
